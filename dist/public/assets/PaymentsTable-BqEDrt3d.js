import{g as j,j as e,b as f,r as b,t as v,v as w,w as P,x as p,y as N,z as r,D as S,F as T}from"./index-BwDYrgBi.js";import{P as C}from"./PaymentService-Bz4ZMB6G.js";const H=(m,n)=>{const{data:o,isLoading:d,isError:x,error:y}=j({queryKey:["payments",m,n],queryFn:()=>C.getPayments(m,n)});return{payments:o,isLoading:d,isError:x,error:y}},R=()=>e.jsxs("div",{className:"mt-10 flex flex-col items-center justify-center border border-gray-200 rounded-2xl shadow-sm p-10 bg-white text-center space-y-4 max-w-md mx-auto",children:[e.jsx("div",{className:"bg-gray-100 p-4 rounded-full"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"No Payments Found"}),e.jsx("p",{className:"text-gray-500 text-sm max-w-sm",children:"There are no payment records in the system at the moment."})]}),F=({payments:m})=>{var c;const n=((c=m.payments)==null?void 0:c.flatMap(t=>t.data.data.attributes.data.attributes.payments.map(s=>s.attributes)))||[],o=n.filter(t=>t.status==="paid").reduce((t,l)=>t+l.amount/100,0),d=n.filter(t=>t.status==="refunded").reduce((t,l)=>t+l.amount/100,0),x=n.reduce((t,l)=>t+(l.fee/100||0),0),y=o-d-x,u=t=>t.toLocaleString("en-PH",{style:"currency",currency:"PHP"});return e.jsx("div",{className:"flex flex-col  mb-6 gap-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 flex-grow",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-500 font-medium",children:"Total Revenue"}),e.jsx("div",{className:"text-xl font-bold text-green-600",children:u(y)})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-500 font-medium",children:"Total Paid"}),e.jsx("div",{className:"text-xl font-bold text-blue-600",children:u(o)})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-500 font-medium",children:"Total Refunded"}),e.jsx("div",{className:"text-xl font-bold text-red-600",children:u(d)})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-500 font-medium",children:"PayMongo Fee"}),e.jsx("div",{className:"text-xl font-bold text-yellow-600",children:u(x)})]})]})})},O=()=>{var l;const m=f(),[n,o]=b.useState(0),[d,x]=b.useState(5),y=(s,i)=>{o(i)},u=s=>{x(parseInt(s.target.value,10)),o(0)},{payments:c}=H(n,d),t=s=>{m(`/payments/viewpaymentdetail/${s}`)};return e.jsxs(e.Fragment,{children:[e.jsx(F,{payments:c}),e.jsx("div",{children:c.payments.length===0?e.jsx(R,{}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"border border-gray-300 rounded-lg shadow-md",children:e.jsxs(w,{size:"small",sx:{tableLayout:"fixed",width:"100%"},children:[e.jsx(P,{children:e.jsx(p,{children:N.paymentTableHeads.map((s,i)=>e.jsx(r,{style:s.style,children:s.label},i))})}),e.jsx(S,{children:(l=c.payments)==null?void 0:l.map(s=>{var h,g;const i=s.data.data.attributes.data.attributes,a=i.payments[0].attributes;return e.jsxs(p,{onClick:()=>t(s.id),className:"cursor-pointer transition duration-200 ease-in-out hover:bg-gray-100",children:[e.jsx(r,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:i.payments[0].id}),e.jsx(r,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:i.reference_number}),e.jsx(r,{children:a.billing.name}),e.jsx(r,{children:(a.amount/100).toLocaleString("en-PH",{style:"currency",currency:a.currency})}),e.jsx(r,{style:{color:a.status==="paid"?"green":"red",fontWeight:"bold"},children:a.status}),e.jsx(r,{children:`${((g=(h=a.source.brand)==null?void 0:h.toUpperCase)==null?void 0:g.call(h))||a.source.type} •••• ${a.source.last4}`}),e.jsx(r,{children:new Date(s.createdAt).toLocaleString("en-PH",{dateStyle:"medium",timeStyle:"short"})}),e.jsx(r,{children:(a.fee/100).toLocaleString("en-PH",{style:"currency",currency:a.currency})}),e.jsx(r,{children:(a.net_amount/100).toLocaleString("en-PH",{style:"currency",currency:a.currency})})]},s.id)})})]})}),e.jsx(T,{rowsPerPageOptions:[5,10,25],component:"div",count:c.totalItems,rowsPerPage:d,page:n,onPageChange:y,onRowsPerPageChange:u})]})})]})};export{O as default};
